<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Я вытащу тебя со дна</title>
  <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
  <script src="window.js"></script>
  <link rel="stylesheet" href="windowbar.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600&family=TikTok+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    
    body {
      margin: 0;
      background: #080808;
      color: #fff;
      font-family: "TikTok Sans", sans-serif;
      overflow: hidden;
    }

    .player-container { padding: 20px;}
    .top-section { display: flex; gap: 20px; align-items: flex-start; }
    .cover { width: 170px; height: 170px; background: #222; flex-shrink: 0; }
    .cover img { width: 100%; height: 100%; object-fit: cover; border-radius: 5px; }
    .right-side { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
    .track-info { margin-bottom: 10px; }
    .title { font-size: 16px; font-weight: 600; margin-bottom: 4px; color: #fff; }
    .artist { font-size: 13px; color: #999; }
    .progress { margin-top: 50px; position: relative; }

    /* Прогресс бар */
    #seekbar {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      background: linear-gradient(to right, #fff 0%, #666 0%);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
      position: relative;
    }
    #seekbar::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    #seekbar:hover::-webkit-slider-thumb { opacity: 1; }

    /* Подсказка */
    .tooltip {
      position: absolute;
      background: rgba(0,0,0,0.8);
      color: #fff;
      font-size: 11px;
      padding: 3px 6px;
      border-radius: 4px;
      transform: translate(-50%, -120%);
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.1s ease;
    }

    .time { font-size: 12px; color: #666; display: flex; justify-content: space-between; margin-top: 5px; }

    .controls { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
    .controls .buttons { display: flex; gap: 20px; }
    .controls button {
      background: none; border: none; color: #ccc;
      font-size: 18px; cursor: pointer;
      transition: color 0.2s ease;
    }
    .controls button:hover, .controls button.active { color: #fff; }

    /* Слайдер громкости */
    .volume-container { display: flex; align-items: center; gap: 10px; min-width: 130px; }
    .volume-container i { font-size: 16px; color: #ccc; transition: color 0.2s; }
    .volume-container i.active { color: #fff; }
    .volume-slider {
      -webkit-appearance: none;
      width: 100px;
      height: 5px;
      border-radius: 5px;
      background: linear-gradient(to right, #fff 100%, #333 100%);
      outline: none;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
    }

    .playlist { margin-top: 30px; max-height: 500px; overflow-y: auto; border-top: 1px solid #222; }
    .track-item {
      display: flex; align-items: center;
      padding: 10px; cursor: pointer;
      border-bottom: 1px solid #111;
      transition: background 0.2s;
    }
    .track-item:hover { background-color: #111; }
    .track-item.active { background-color: #222; }
    .track-item img {
      width: 50px; height: 50px;
      object-fit: cover; margin-right: 15px;
      flex-shrink: 0; border-radius: 5px;
    }
    .track-details { display: flex; flex-direction: column; }
    .track-details .title { font-size: 14px; font-weight: 500; }
    .track-details .artist { font-size: 12px; color: #888; }
  </style>
  <style>
.playlist {

  overflow-y: auto;
  padding: 10px;

  border-radius: 12px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

/* WebKit (Chrome, Edge, Safari) */
.playlist::-webkit-scrollbar {
  width: 8px;
}

.playlist::-webkit-scrollbar-track {
  background: #000000;
  border-radius: 10px;
}

.playlist::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #000000, #000000);
  border-radius: 10px;
  transition: background 0.3s;
}

.playlist::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #ffffff, #ffffff);
}

/* Firefox */
.playlist {
  scrollbar-width: thin;
  scrollbar-color: #000000 #000000;
}

</style>
</head>
<body>
  <div class="window-bar">
        <div class="window-title">
            <a href="#" class="glow-animate" style="color: white; text-decoration: none; font-family: syne;">STREAMIFY</a>
        </div>
        <div class="window-controls">
            <button class="minimize">—</button>
            <button class="close">×</button>
        </div>
    </div>
  <div class="player-container">
    <div class="top-section">
      <div class="cover"><img src="" alt="Обложка"></div>
      <div class="right-side">
        <div class="track-info">
          <div class="title">Название</div>
          <div class="artist">Артист</div>
        </div>
        <div class="progress">
          <input type="range" id="seekbar" value="0" max="100">
          <div id="tooltip" class="tooltip"></div>
          <div class="time">
            <span id="currentTime">0:00</span>
            <span id="duration">0:00</span>
          </div>
        </div>
        <div class="controls">
          <div class="buttons">
            <button title="Перемешать"><i class="fa-solid fa-shuffle"></i></button>
            <button title="Назад"><i class="fa-solid fa-backward-step"></i></button>
            <button id="playBtn" title="Воспроизвести"><i class="fa-solid fa-play"></i></button>
            <button title="Вперёд" id="nextBtn"><i class="fa-solid fa-forward-step"></i></button>
            <button id="repeatBtn" title="Повтор"><i class="fa-solid fa-repeat"></i></button>
          </div>
          <div class="volume-container">
            <i id="volumeIcon" class="fa-solid fa-volume-high"></i>
            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1">
          </div>
        </div>
      </div>
    </div>
    <audio id="audioPlayer"></audio>
    <div class="playlist" id="playlist"></div>
  </div>

  <script>
    const audio = document.getElementById('audioPlayer');
    const playBtn = document.getElementById('playBtn');
    const nextBtn = document.getElementById('nextBtn');
    const seekbar = document.getElementById('seekbar');
    const currentTimeElem = document.getElementById('currentTime');
    const durationElem = document.getElementById('duration');
    const repeatBtn = document.getElementById('repeatBtn');
    const volumeSlider = document.getElementById('volumeSlider');
    const volumeIcon = document.getElementById('volumeIcon');
    const titleElem = document.querySelector('.title');
    const artistElem = document.querySelector('.artist');
    const coverImg = document.querySelector('.cover img');
    const prevBtn = document.querySelector('button[title="Назад"]');
    const shuffleBtn = document.querySelector('button[title="Перемешать"]');
    const playlistContainer = document.getElementById('playlist');
    const tooltip = document.getElementById('tooltip');

    let isPlaying = false;
    let isRepeating = false;
    let currentTrackIndex = 0;

    const playlist = [
      { title: 'я молодой вампир vamp', artist: 'Урал Гайсин', src: 'http://192.168.1.58:5000/music/УралГайсин/я молодой вампир vamp', cover: 'https://i.pinimg.com/736x/ee/c8/a9/eec8a9cb9c496946b543ab2e39bd2113.jpg' },
      { title: 'ThankGod', artist: 'Cowboyclicker', src: 'http://192.168.1.58:5000/music/Cowboyclicker/thankgod', cover: 'https://i.pinimg.com/736x/a5/fe/1c/a5fe1c0a82b8ec40d69696fbe3c6aaf2.jpg' },
      { title: 'Она мне', artist: 'Урал Гайсин', src: 'http://192.168.1.58:5000/music/УралГайсин/Она_мне', cover: 'https://i.pinimg.com/736x/ee/c8/a9/eec8a9cb9c496946b543ab2e39bd2113.jpg' },
      { title: '5ive', artist: 'Lovv66', src: 'http://192.168.1.58:5000/music/lovv66/5IVE', cover: 'https://i.pinimg.com/736x/8a/37/b6/8a37b62a8209259eab426280555164b3.jpg' },
      { title: 'NEW JEANS(tiktok kek)', artist: 'jersey', src: 'http://192.168.1.58:5000/music/jersey/NewJeans', cover: 'https://i.pinimg.com/736x/a6/dd/d9/a6ddd9ab6185e9bd7adee3910b947e36.jpg' },
      { title: 'mad mode', artist: 'IVOXYGEN', src: 'http://192.168.1.58:5000/music/IVOXYGEN/mad_mode', cover: 'https://i.pinimg.com/736x/67/4c/4b/674c4b83f50b31f533213be38d7d5a95.jpg' },
      { title: 'VISION', artist: 'UDISTRUCT', src: 'http://192.168.1.58:5000/music/UDISTRUCT/VISION', cover: 'https://i.pinimg.com/736x/90/a3/53/90a353f139f0b21ad1a0305b03478a3c.jpg' },
      { title: 'Рейман', artist: 'FACE', src: 'http://192.168.1.58:5000/music/FACE/Рэйман', cover: 'https://i.pinimg.com/736x/11/94/91/1194914c9ad201d583d3e45c08c77328.jpg' },
      { title: 'Yesvuiskiii', artist: 'CLONNEX', src: 'http://192.168.1.58:5000/music/CLONNEX/Yesvuiskiii', cover: 'https://i.pinimg.com/736x/ea/c7/9a/eac79a12b0dc678b1f71b8aa6c5a3a65.jpg' },
      { title: 'Phoenix', artist: '9mice, Kai Angel', src: 'http://192.168.1.58:5000/music/9mice/Phoenix', cover: 'https://i.pinimg.com/736x/78/5a/8f/785a8f7e046fae0029955b4e17e9e5ed.jpg' }
      
    ];

    function renderPlaylist() {
      playlistContainer.innerHTML = '';
      playlist.forEach((track, index) => {
        const trackElem = document.createElement('div');
        trackElem.classList.add('track-item');
        if (index === currentTrackIndex) trackElem.classList.add('active');
        trackElem.innerHTML = `<img src="${track.cover}" alt="cover">
          <div class="track-details"><div class="title">${track.title}</div><div class="artist">${track.artist}</div></div>`;
        trackElem.addEventListener('click', () => {
          if (currentTrackIndex === index && isPlaying) {
            audio.pause(); isPlaying = false; playBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
          } else {
            currentTrackIndex = index;
            loadTrack(index); audio.play(); isPlaying = true;
            playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
          }
        });
        playlistContainer.appendChild(trackElem);
      });
    }

    function loadTrack(index) {
      const track = playlist[index];
      titleElem.textContent = track.title;
      artistElem.textContent = track.artist;
      coverImg.src = track.cover;
      audio.src = track.src;
      seekbar.value = 0;
      currentTimeElem.textContent = '0:00';
      durationElem.textContent = '0:00';
      updateActiveTrack();
      if (isPlaying) audio.play();
    }

    function updateActiveTrack() {
      document.querySelectorAll('.track-item').forEach((el, i) => el.classList.toggle('active', i === currentTrackIndex));
    }

    function formatTime(sec) {
      const minutes = Math.floor(sec / 60);
      const seconds = Math.floor(sec % 60);
      return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }

    function updateProgressBar() {
      if (!isNaN(audio.duration)) {
        const percent = (audio.currentTime / audio.duration) * 100;
        seekbar.value = percent;
        seekbar.style.background = `linear-gradient(to right, #fff ${percent}%, #666 ${percent}%)`;
        currentTimeElem.textContent = formatTime(audio.currentTime);
      }
      requestAnimationFrame(updateProgressBar);
    }
    requestAnimationFrame(updateProgressBar);

    seekbar.addEventListener('input', () => audio.currentTime = (seekbar.value / 100) * audio.duration);

    seekbar.addEventListener('mousemove', (e) => {
      if (!audio.duration) return;
      const rect = seekbar.getBoundingClientRect();
      const percent = Math.min(Math.max(0, (e.clientX - rect.left) / rect.width), 1);
      tooltip.style.left = `${e.clientX - rect.left}px`;
      tooltip.textContent = formatTime(percent * audio.duration);
      tooltip.style.opacity = 1;
    });
    seekbar.addEventListener('mouseleave', () => tooltip.style.opacity = 0);
    seekbar.addEventListener('click', (e) => {
      const rect = seekbar.getBoundingClientRect();
      const percent = Math.min(Math.max(0, (e.clientX - rect.left) / rect.width), 1);
      audio.currentTime = percent * audio.duration;
    });

    audio.addEventListener('loadedmetadata', () => durationElem.textContent = formatTime(audio.duration));
    
    // Улучшенный контроль громкости
    function updateVolumeUI(value) {
      const percent = value * 100;
      volumeSlider.style.background = `linear-gradient(to right, #fff ${percent}%, #333 ${percent}%)`;
      if (value === 0) {
        volumeIcon.className = "fa-solid fa-volume-xmark";
      } else if (value < 0.5) {
        volumeIcon.className = "fa-solid fa-volume-low";
      } else {
        volumeIcon.className = "fa-solid fa-volume-high";
      }
    }
    volumeSlider.addEventListener('input', () => {
      audio.volume = volumeSlider.value;
      updateVolumeUI(volumeSlider.value);
    });
    updateVolumeUI(volumeSlider.value);

    audio.addEventListener('ended', () => { if (!isRepeating) nextTrack(); });

    playBtn.addEventListener('click', () => {
      if (isPlaying) { audio.pause(); playBtn.innerHTML = '<i class="fa-solid fa-play"></i>'; }
      else { audio.play(); playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>'; }
      isPlaying = !isPlaying;
    });
    repeatBtn.addEventListener('click', () => { isRepeating = !isRepeating; audio.loop = isRepeating; repeatBtn.classList.toggle('active', isRepeating); });
    prevBtn.addEventListener('click', () => { currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length; loadTrack(currentTrackIndex); if (isPlaying) audio.play(); });
    nextBtn.addEventListener('click', () => nextTrack());
    shuffleBtn.addEventListener('click', () => { const current = playlist[currentTrackIndex]; playlist.sort(() => Math.random() - 0.5); currentTrackIndex = playlist.findIndex(t => t.src === current.src); renderPlaylist(); loadTrack(currentTrackIndex); });

    function nextTrack() {
      currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
      loadTrack(currentTrackIndex);
      if (isPlaying) { audio.play(); playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>'; }
    }

    loadTrack(currentTrackIndex);
    renderPlaylist();
  </script>
</body>
</html>
